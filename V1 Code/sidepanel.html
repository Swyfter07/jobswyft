<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>JobSwyft</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Resize Hint Overlay -->
    <div class="resize-hint-overlay" title="Drag the browser edge to resize"></div>

    <!-- 1. Header -->
    <div class="header" style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
        <h1 style="display: flex; align-items: center; gap: 8px; font-size: 18px; margin: 0;">
            <img src="icon3.png" alt="Logo" style="width: 24px; height: 24px; border-radius: 6px;">
            JobSwyft
        </h1>
        <div style="display: flex; align-items: center; gap: 8px;">
            <!-- Status Pill -->
            <div id="tab-status"
                style="font-size: 11px; color: #64748b; background: #f1f5f9; padding: 2px 8px; border-radius: 12px; border: 1px solid #e2e8f0; display: flex; align-items: center; gap: 4px;">
                <span style="color: #10b981; font-weight: bold; font-size: 14px; line-height: 0.5;">&bull;</span> Ready
            </div>
        </div>
    </div>

    <!-- 2. Main Tab Navigation -->
    <div class="tab-container" style="margin-top: 12px; margin-bottom: 12px;">
        <button class="nav-tab active" data-tab="tab-scan">
            <span>‚õ∂</span> Scan
        </button>
        <button class="nav-tab" data-tab="tab-ai-studio">
            <span>‚ú®</span> AI Studio
        </button>
        <button class="nav-tab" data-tab="tab-autofill">
            <span>‚å®</span> Autofill
        </button>
    </div>

    <!-- 3. Active Resume Section (Always visible? User images show it inside Scan/AI Studio? 
         Actually, Image 2 shows "Active Resume" at the top of the "Scan" view (below tabs? No, tabs are top). 
         Let's put Resume Tray just below tabs, available globally or per tab. 
         Image 2: [Header] -> [Scan/AI/Autofill] -> [Tabs for 'Demo State'?] -> [Active Resume] 
         Let's keep it simple: Tabs -> Resume -> Content 
    -->

    <!-- Resume Section (Global) -->



    <!-- ==============================================
         TAB CONTENT: SCAN
         ============================================== -->
    <div id="tab-scan" class="tab-content">
        <!-- Resume Section (Moved here) -->
        <div class="card premium-card" id="active-resume-card"
            style="margin-bottom: 20px; padding: 12px; border-radius: 12px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <div
                    style="display: flex; align-items: center; gap: 6px; font-weight: 600; font-size: 13px; color: #0f172a;">
                    <span>üìÑ</span> Active Resume
                </div>
            </div>
            <div id="resume-container">

            </div>
            <div id="profile-area" style="margin-top: 12px; max-height: 300px; overflow-y: auto;">
                <!-- Increased height for better view -->
                <div id="profile-list"></div>
            </div>
            <div style="display: flex; gap: 6px; margin-top: 8px;">
                <button id="parse-resume-btn" class="secondary" style="font-size: 11px; flex: 1;">Update Smart
                    Blocks</button>
                <button id="inject-resume-btn" class="primary-action" style="font-size: 11px; flex: 1;"
                    title="Upload active resume to file input on job page">üì§ Upload to Page</button>
            </div>
            <input type="file" id="resume-file-input" accept="application/pdf" multiple>
        </div>
        <!-- Status Bar -->
        <div class="scan-status-comple">
            <div class="status-label">
                <div class="status-icon-check">‚úì</div>
                <span>Scan Complete</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <!-- Auto-Scan Toggle -->
                <label class="auto-scan-toggle" title="Auto-scan job pages when opened">
                    <input type="checkbox" id="auto-scan-toggle" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Auto</span>
                </label>
                <button id="scan-page-btn" class="secondary" style="width: auto; padding: 4px 12px; font-size: 11px;">
                    üîÑ Re-scan
                </button>
            </div>
        </div>

        <!-- Job Details Cards -->
        <!-- Title -->
        <div class="job-detail-card">
            <div class="detail-header">
                <span>üíº</span> Job Title <span class="badge-required">Required</span>
            </div>
            <div class="input-group">
                <input type="text" id="job-title" placeholder="Senior Frontend Engineer"
                    style="border:none; padding:0; font-weight: 600; color: #0f172a;">
                <button id="pick-title" class="btn-addon" style="border:none; background:transparent;">üéØ</button>
            </div>
        </div>

        <!-- Company -->
        <div class="job-detail-card">
            <div class="detail-header">
                <span>üè¢</span> Company <span class="badge-required">Required</span>
            </div>
            <div class="input-group">
                <input type="text" id="job-company" placeholder="TechCorp Inc."
                    style="border:none; padding:0; font-weight: 600; color: #0f172a;">
                <button id="pick-company" class="btn-addon" style="border:none; background:transparent;">üéØ</button>
            </div>
        </div>

        <!-- Location, Salary, Employment Type removed per request -->

        <!-- Description -->
        <div class="job-detail-card">
            <div class="detail-header" style="justify-content: space-between;">
                <span>üìù</span> Job Description <span class="badge-required"
                    style="background:#e2e8f0;">Extracted</span>
            </div>
            <div class="input-group">
                <textarea id="job-desc" placeholder="We are looking for..."
                    style="border:none; padding:0; min-height: 80px; font-size: 13px; color: #334155; width: 100%; resize: none;"></textarea>
                <button id="pick-desc" class="btn-addon"
                    style="border:none; background:transparent; align-self: flex-start;">üéØ</button>
            </div>
            <div style="text-align: right; margin-top: 4px;">
                <button id="copy-desc-btn"
                    style="background:none; border:none; color: #2563eb; font-size: 11px; padding:0; width: auto; cursor:pointer;">View
                    full description</button>
            </div>
        </div>

        <!-- Hidden Clear Button for Logic Compliance -->
        <button id="clear-job-btn" style="display:none;">Clear</button>
    </div>


    <!-- ==============================================
         TAB CONTENT: AI STUDIO
         ============================================== -->
    <div id="tab-ai-studio" class="tab-content" style="display: none;">
        <!-- AI Model Selector (Global for this tab) -->
        <div style="margin-bottom: 12px;">
            <label
                style="font-size: 11px; font-weight: 600; text-transform: uppercase; color: #94a3b8; margin-bottom: 4px; display: block;">Active
                Model</label>
            <select id="openai-model-select"
                style="width: 100%; border: 1px solid #cbd5e1; padding: 8px; border-radius: 6px; font-size: 13px; background: #fff;">
                <option value="gpt-4o-mini">GPT-4o Mini (Fast & Cheap)</option>
                <option value="gpt-4o">GPT-4o (Best Quality)</option>
                <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Legacy)</option>
            </select>
        </div>

        <!-- Sub Navigation -->
        <div class="nav-pills">
            <button class="nav-pill active" data-subtab="view-match">
                <span>‚óé</span> Match
            </button>
            <button class="nav-pill" data-subtab="view-cover">
                <span>üìÑ</span> Cover
            </button>
            <button class="nav-pill" data-subtab="view-answer">
                <span>üí¨</span> Answer
            </button>
            <button class="nav-pill" data-subtab="view-outreach">
                <span>‚úà</span> Outreach
            </button>
        </div>

        <!-- VIEW: MATCH -->
        <div id="view-match" class="sub-view">
            <!-- Reuse AI Insights Logic here -->
            <div class="card-premium">
                <div class="match-header">
                    <span style="font-weight: 600; font-size: 14px;">Resume Match Analysis</span>
                    <span class="credit-badge">1 credit</span>
                </div>
                <p style="font-size: 12px; color: #64748b; margin-bottom: 12px;">
                    Compare your active resume against the job requirements.
                </p>

                <!-- API Key Logic Container (Hidden if key exists) -->
                <div id="ai-key-view" style="display: none; margin-bottom: 12px;">
                    <input type="password" id="openai-key-input" placeholder="Enter OpenAI API Key"
                        style="width: 100%; border: 1px solid #e2e8f0; padding: 8px; border-radius: 6px; font-size: 12px; margin-bottom: 8px;">



                    <button id="save-key-btn" style="width: 100%;">Save Settings</button>
                </div>

                <!-- Analyze Button -->
                <button id="ai-analyze-btn"
                    style="width: 100%; padding: 12px; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <span>‚ú®</span> Re-analyze
                </button>
            </div>

            <!-- Score Card (Dynamically populated) -->
            <div id="ai-results-container">
                <!-- Results will look like: 
                 <div class="card-premium">
                    <div class="match-score-container">
                        <span style="font-size: 13px; color: #64748b;">Match Score</span>
                        <span class="score-text">85%</span>
                    </div>
                    <div class="progress-track"><div class="progress-fill" style="width: 85%;"></div></div>
                 </div>
                 ... Strengths ... 
                 -->
                <div style="text-align: center; color: #94a3b8; font-size: 12px; padding: 20px;">
                    No analysis yet. Click 'Re-analyze' to start.
                </div>
            </div>

            <!-- Hidden elements for logic compatibility -->
            <div id="header-ai-insights" style="display:none;"></div>
        </div>

        <!-- VIEW: COVER LETTER -->
        <div id="view-cover" class="sub-view" style="display: none;">
            <div class="card-premium">
                <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 12px;">Cover Letter Generator</h3>
                <!-- Inputs -->
                <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                    <select id="cover-length" style="flex:1;">
                        <option value="medium">Medium Length</option>
                        <option value="short">Short</option>
                        <option value="long">Long</option>
                    </select>
                    <select id="cover-tone" style="flex:1;">
                        <option value="professional">Professional</option>
                        <option value="confident">Confident</option>
                    </select>
                </div>
                <button id="generate-cover-btn" style="background-color: #059669;">Generate Letter</button>

                <div id="cover-letter-output" style="display: none; margin-top: 16px;">
                    <div class="editable-output" id="cover-letter-text" contenteditable="true"></div>
                    <div style="display: flex; gap: 8px; margin-top: 8px;">
                        <button id="copy-cover-btn" class="secondary" style="flex:1;">Copy</button>
                        <button id="export-cover-pdf-btn" class="secondary" style="flex:1;">PDF</button>
                    </div>
                    <input type="text" id="cover-feedback-input" placeholder="Feedback..." style="margin-top: 8px;">
                    <button id="regenerate-cover-btn" class="secondary" style="margin-top: 4px;">Regenerate</button>
                </div>
            </div>
            <div id="header-cover-letter" style="display:none;"></div>
        </div>

        <!-- VIEW: ANSWER -->
        <div id="view-answer" class="sub-view" style="display: none;">
            <div class="card-premium">
                <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 12px;">AI Answer Generator</h3>
                <textarea id="ai-question-input" placeholder="Paste question here..."
                    style="width:100%; margin-bottom: 12px;"></textarea>

                <!-- Hidden inputs mapping -->
                <select id="answer-length" style="display:none;">
                    <option value="medium">Medium</option>
                </select>
                <select id="answer-tone" style="display:none;">
                    <option value="professional">Professional</option>
                </select>

                <button id="generate-answer-btn" style="background-color: #8b5cf6;">Generate Answer</button>

                <div id="ai-answer-output" style="display: none; margin-top: 16px;">
                    <div class="editable-output" id="ai-answer-text"></div>
                    <button id="copy-answer-btn" class="secondary" style="margin-top: 8px; width: 100%;">Copy</button>
                    <input type="text" id="answer-feedback-input" placeholder="Feedback..." style="margin-top: 8px;">
                    <button id="regenerate-answer-btn" class="secondary"
                        style="margin-top: 4px; width: 100%;">Regenerate</button>
                </div>
            </div>
            <div id="header-answer-gen" style="display:none;"></div>
        </div>

        <!-- VIEW: OUTREACH -->
        <div id="view-outreach" class="sub-view" style="display: none;">
            <div class="card-premium">
                <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 12px;">Outreach Message</h3>
                <input type="text" id="outreach-manager-name" placeholder="Hiring Manager Name"
                    style="margin-bottom: 8px;">
                <select id="outreach-type" style="margin-bottom: 8px;">
                    <option value="linkedin_connection">LinkedIn Connect</option>
                    <option value="linkedin_inmail">InMail</option>
                    <option value="cold_email">Cold Email</option>
                </select>
                <!-- Tone hidden mapping -->
                <select id="outreach-tone" style="display:none;">
                    <option value="professional">Pro</option>
                </select>

                <button id="generate-outreach-btn" style="background-color: #7c3aed;">Generate Message</button>

                <div id="outreach-output" style="display: none; margin-top: 16px;">
                    <div class="editable-output" id="outreach-text" contenteditable="true"></div>
                    <button id="copy-outreach-btn" class="secondary" style="margin-top: 8px; width: 100%;">Copy</button>
                    <input type="text" id="outreach-feedback-input" placeholder="Feedback..." style="margin-top: 8px;">
                    <button id="regenerate-outreach-btn" class="secondary"
                        style="margin-top: 4px; width: 100%;">Regenerate</button>
                    <button id="clear-outreach-btn" style="display:none;">Clear</button>
                </div>
            </div>
            <div id="header-outreach" style="display:none;"></div>
        </div>

    </div>

    <!-- ==============================================
         TAB CONTENT: AUTOFILL
         ============================================= -->
    <div id="tab-autofill" class="tab-content" style="display: none;">
        <div class="card-premium">
            <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 12px;">Smart Autofill</h3>
            <p style="font-size: 12px; color: #64748b; margin-bottom: 12px;">
                Use your Resume data to autofill application forms.
            </p>
            <button id="autofill-form-btn" style="background-color: #6366f1;">‚ú® Autofill Current Page</button>
            <div id="app-tracker-container" style="margin-top: 20px;"></div>
        </div>
    </div>


    <!-- Hidden legacy logic requirements -->
    <!-- The sidepanel.js expects certain IDs to exist for collapsibles, etc. 
         I've re-mapped most critical IDs (btns, inputs). 
         Some collapsible logic might fail if classes '.card' don't exist in same hierarchy, 
         but the core feature logic (event listeners on buttons) should work. 
    -->

    <script src="lib/pdf.min.js"></script>
    <script src="prompts.js"></script>
    <script src="sidepanel.js"></script>
</body>

</html>